<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="cn.thinkjoy.saas.dao.bussiness.EXITenantConfigInstanceDAO">

    <resultMap id="Base_Result_Mapper" type="cn.thinkjoy.saas.domain.TenantConfigInstance">
        <id column="id" property="id" jdbcType="INTEGER" />
        <result column="tn_id" property="tnId" jdbcType="INTEGER" />
        <result column="ch_name" property="chName" jdbcType="VARCHAR" />
        <result column="config_key" property="configKey" jdbcType="VARCHAR" />
        <result column="config_order" property="configOrder" jdbcType="INTEGER" />
        <result column="check_rule" property="checkRule" jdbcType="VARCHAR" />
        <result column="domain" property="domain" jdbcType="VARCHAR" />
        <result column="create_date" property="createDate" jdbcType="BIGINT" />
        <result column="modify_date" property="modifyDate" jdbcType="BIGINT" />
    </resultMap>
    <sql id="Base_Column_List">
        id,
        tn_id,
        config_key,
        config_order,
        check_rule,
        domain,
        create_date,
        modify_date
    </sql>
    <delete id="removeTeantConfigs" parameterType="java.util.List">

        DELETE FROM saas_tenant_config_instance where id in

        <foreach item="idItem" collection="list" open="(" separator="," close=")">
            #{idItem}
        </foreach>

    </delete>
    <insert id="addConfigs" useGeneratedKeys="true" parameterType="java.util.List">
        <selectKey resultType="long" keyProperty="id" order="AFTER">
            SELECT
            LAST_INSERT_ID()
        </selectKey>
        insert into saas_tenant_config_instance(
        tn_id,
        config_key,
        config_order,
        check_rule,
        domain,
        create_date,
        modify_date)
        values
        <foreach collection="list" item="item" index="index" separator="," >
            (#{item.tnId},#{item.configKey},#{item.configOrder},#{item.checkRule},#{item.domain},#{item.createDate},#{item.modifyDate})
        </foreach>
    </insert>

    <update id="sortConfigUpdate"  parameterType="java.util.List">

        <foreach collection="list" item="item" index="index" open="" close="" separator=";">
            update saas_tenant_config_instance
            <set>
                config_order=${item.configOrder}
            </set>
            where id = ${item.id}
        </foreach>

    </update>

</mapper>